import{a as e,c as s,b as i,_ as m,d as k,y as R,z as L,F as w,A as g,l as _,C as T,t as y,w as C,D as $,f as p,g as x,r as z,x as I,k as f,s as A,p as V,h as H,B as U,n as G,K as F}from"./index.62268a27.js";import{g as M,a as S,A as N}from"./ArticleItem.eadcde56.js";import{b as E,R as b,K as j}from"./ResponseResult.f1dd6b90.js";import{I as B}from"./baseline-close.dfc8d16c.js";import"./openDB.477f2690.js";const K={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Y=i("path",{fill:"currentColor",d:"M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zm0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zM3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1z"},null,-1),O=[Y];function Q(a,t){return e(),s("svg",K,O)}var q={name:"ic-round-menu",render:Q};const P=async(a,t)=>{const l=await fetch(`${E}/v1_0/articles?channel_id=${a}&timestamp=${t}`,{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:`Bearer ${await M()}`}});return l.ok?new b("getChannelRecommendArticles","success",l):new b("getChannelRecommendArticles","failure",l)},J=S(P);const W={class:"article-list"},X=k({__name:"ArticleList",props:{channelId:null,page:null,eachPageCount:null},async setup(a){let t,l;const u=a,n=R([]);return j(([t,l]=L(()=>J(u.channelId,Date.now())),t=await t,l(),t)).with({responseType:"success"},async h=>{(await h.lastContent().json()).data.results.forEach(o=>{n.push({id:parseInt(o.art_id),title:o.title,authorId:parseInt(o.aut_id),author:o.aut_name,commentsCount:parseInt(o.comm_count),publishDate:new Date(o.pubdate),cover:{type:o.cover.type,urls:o.cover.images}})})}).otherwise(h=>{console.log(h.responseResultQueue)}),(h,r)=>(e(),s("div",W,[(e(!0),s(w,null,g(n,o=>(e(),_(N,{key:o.id,article:o},null,8,["article"]))),128))]))}});var Z=m(X,[["__scopeId","data-v-1f62ce96"]]);const ee={},ae={class:"article-list-loading"};function te(a,t){return e(),s("div",ae," Loading... ")}var ne=m(ee,[["render",te],["__scopeId","data-v-1eec10d4"]]);const se=async()=>{const a=await fetch(`${E}/v1_0/user/channels`,{method:"GET",mode:"cors",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:`Bearer ${await M()}`}});return a.ok?new b("getUserChannels","success",a):new b("getUserChannels","failure",a)},oe=S(se),ie=async()=>{const a=await fetch(`${E}/v1_0/channels`,{method:"GET",mode:"cors",headers:{"Content-Type":"application/json;charset=utf-8"}});return a.ok?new b("getRecommendChannels","success",a):new b("getRecommendChannels","failure",a)},le={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ce=i("path",{fill:"currentColor",d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},null,-1),re=[ce];function de(a,t){return e(),s("svg",le,re)}var ue={name:"ic-baseline-add",render:de};const he={class:"channel-list"},ve={class:"add"},pe=k({__name:"RecommendChannelList",props:{isEditing:{type:Boolean}},async setup(a){let t,l;const u=a,n=R([]),h=([t,l]=L(()=>ie()),t=await t,l(),t);return j(h).with({responseType:"success"},async r=>{(await r.responseContent.json()).data.channels.forEach(d=>{n.push(d)})}).otherwise(r=>{console.error(r)}),(r,o)=>(e(),s("div",he,[(e(!0),s(w,null,g(n,d=>(e(),s("div",{key:d.id,class:"item"},[T(y(d.name)+" ",1),C(i("div",ve,[p(x(ue),{class:"icon"})],512),[[$,u.isEditing]])]))),128))]))}});var _e=m(pe,[["__scopeId","data-v-7857a49a"]]);const fe={},we={class:"channel-list-loading"};function be(a,t){return e(),s("div",we," Loading... ")}var me=m(fe,[["render",be],["__scopeId","data-v-58007658"]]);const D=a=>(V("data-v-533ae9bb"),a=a(),H(),a),ge={class:"edit-channel"},ye={class:"row-top"},xe={key:0,class:"close"},ke={class:"my-channels"},Ce=D(()=>i("h3",null,"\u6211\u7684\u9891\u9053",-1)),$e={class:"channel-list"},ze={class:"delete"},Ie={class:"recommend-channels"},Ae=D(()=>i("h3",null,"\u9891\u9053\u63A8\u8350",-1)),Re=k({__name:"EditChannel",props:{channels:null},emits:["close"],setup(a,{emit:t}){const l=a,u=()=>{t("close")};let n=z(!1);const h=()=>{n.value=!n.value},r=()=>{n.value=!1};return(o,d)=>(e(),s("div",ge,[i("div",ye,[n.value?I("",!0):(e(),s("span",xe,[p(x(B),{class:"icon",onClick:u})])),C(i("button",{class:"cancel",onClick:r}," \u53D6\u6D88 ",512),[[$,n.value]]),i("button",{class:"edit",onClick:h},y(n.value?"\u5B8C\u6210":"\u7F16\u8F91"),1)]),i("section",ke,[Ce,i("div",$e,[(e(!0),s(w,null,g(l.channels,v=>(e(),s("div",{key:v.id,class:"item"},[T(y(v.name)+" ",1),C(i("div",ze,[p(x(B),{class:"icon"})],512),[[$,n.value]])]))),128))])]),i("section",Ie,[Ae,(e(),_(A,null,{fallback:f(()=>[p(me)]),default:f(()=>[p(_e,{"is-editing":n.value},null,8,["is-editing"])]),_:1}))])]))}});var Le=m(Re,[["__scopeId","data-v-533ae9bb"]]);const Ee={class:"main-home"},je={class:"suspense-container"},Be={class:"channel-tab-bar"},Te=["onClick"],Me={class:"title"},Se=k({__name:"MainHome",async setup(a){let t,l;const u=R([]);let n=z("0");j(([t,l]=L(()=>oe()),t=await t,l(),t)).with({responseType:"success"},async d=>{const v=await d.lastContent().json();v.data.channels.forEach(c=>{u.push({id:c.id.toString(),name:c.name})}),n.value=v.data.channels[0].id.toString()}).otherwise(d=>{console.log(d.responseResultQueue)});const h=d=>{n.value=d.id};let r=z(!1);const o=()=>{r.value=!0};return(d,v)=>(e(),s("div",Ee,[(e(),_(A,null,{default:f(()=>[i("div",je,[i("nav",Be,[(e(!0),s(w,null,g(u,c=>(e(),s("div",{key:c.id,class:G(["item",{"-active":n.value===c.id}]),onClick:De=>h(c)},[i("span",Me,y(c.name),1)],10,Te))),128)),u.length>=4?(e(),s("div",{key:0,class:"menu",onClick:o},[p(x(q),{class:"icon1"})])):I("",!0)]),(e(),_(F,{max:10},[(e(),_(A,null,{fallback:f(()=>[p(ne)]),default:f(()=>[(e(!0),s(w,null,g(u,c=>(e(),s(w,{key:c.id},[c.id===n.value?(e(),_(Z,{key:0,"channel-id":c.id},null,8,["channel-id"])):I("",!0)],64))),128))]),_:1}))],1024))])]),_:1})),p(U,{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=c=>r.value=c),"slot-transition-name":"slide"},{default:f(()=>[p(Le,{channels:u,onClose:v[0]||(v[0]=c=>r.value=!1)},null,8,["channels"])]),_:1},8,["modelValue"])]))}});var Ne=m(Se,[["__scopeId","data-v-ef788970"]]);export{Ne as default};
