import{g as C,a as R,A as $}from"./ArticleItem.eadcde56.js";import{b,R as f,K as S}from"./ResponseResult.f1dd6b90.js";import{u as j}from"./articleSearch.7cc43881.js";import{a as l,c as p,b as u,_ as k,d as I,z as A,r as x,f as v,g as y,l as h,p as z,h as B,y as L,F as T,A as V,B as D,k as g,s as E}from"./index.62268a27.js";import{I as F}from"./baseline-close.dfc8d16c.js";import{I as O}from"./round-star.7b12db50.js";import"./openDB.477f2690.js";const U=async(a,e,s)=>{const o=new URL(`${b}/v1_0/search`);o.searchParams.set("q",a),e!==void 0&&o.searchParams.set("page",e.toString()),s!==void 0&&o.searchParams.set("per_page",s.toString());const n=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8"}});return n.ok?new f("getSearchArticle","success",n):new f("getSearchArticle","failure",n)},G={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},M=u("path",{fill:"currentColor",d:"m19.65 9.04l-4.84-.42l-1.89-4.45c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18l-1.1 4.72c-.2.86.73 1.54 1.49 1.08l4.15-2.5l4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.73l3.67-3.18c.67-.58.32-1.68-.56-1.75zM12 15.4l-3.76 2.27l1-4.28l-3.32-2.88l4.38-.38L12 6.1l1.71 4.04l4.38.38l-3.32 2.88l1 4.28L12 15.4z"},null,-1),q=[M];function N(a,e){return l(),p("svg",G,q)}var P={name:"ic-round-star-border",render:N};const Y=async a=>{const e=await fetch(`${b}/v1_0/articles/${a}`,{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:`Bearer ${await C()}`}});return e.ok?new f("getSearchArticle","success",e):new f("getSearchArticle","failure",e)},K=R(Y);const H=a=>(z("data-v-823ccaa4"),a=a(),B(),a),J={class:"read-article"},Q={class:"row-top"},W={class:"close"},X=H(()=>u("div",{class:"title"}," article title ",-1)),Z={class:"star"},ee=I({__name:"ReadArticle",props:{id:null},emits:["cancel"],async setup(a,{emit:e}){let s,o;const n=a;console.log("request start");try{S(([s,o]=A(()=>K(n.id)),s=await s,o(),s)).with({responseType:"success"},async t=>{const r=await t.lastContent().json();console.log(r)}).otherwise(t=>{console.error(t)})}catch(t){console.error(t)}const _=()=>{e("cancel")};let i=x(!1);const w=()=>{i.value=!0},m=()=>{i.value=!1};return(t,r)=>(l(),p("div",J,[u("div",Q,[u("span",W,[v(y(F),{class:"icon",onClick:_})]),X,u("span",Z,[i.value?(l(),h(y(O),{key:0,class:"icon",onClick:m})):(l(),h(y(P),{key:1,class:"icon",onClick:w}))])])]))}});var te=k(ee,[["__scopeId","data-v-823ccaa4"]]);const ae={},se={class:"read-article-loading"};function oe(a,e){return l(),p("div",se," Loading... ")}var re=k(ae,[["render",oe],["__scopeId","data-v-11268602"]]);const ce={class:"search-result"},le={class:"transition-container"},ne=I({__name:"SearchResult",async setup(a){let e,s;const o=j(),n=L([]);try{const t=o.searchValue;t.trim()!==""&&S(([e,s]=A(()=>U(t,1,10)),e=await e,s(),e)).with({responseType:"success"},async r=>{(await r.responseContent.json()).data.results.forEach(c=>{n.push({id:parseInt(c.art_id),title:c.title,authorId:parseInt(c.aut_id),author:c.aut_name,commentsCount:parseInt(c.comm_count),publishDate:new Date(c.pubdate),cover:{type:parseInt(c.cover.type),urls:c.cover.images}})})}).otherwise(r=>{console.error(r)})}catch(t){console.error(t)}let _=x(0),i=x(!1);const w=t=>{_.value=t,i.value=!0},m=()=>{i.value=!1};return(t,r)=>(l(),p("div",ce,[(l(!0),p(T,null,V(n,d=>(l(),h($,{key:d.id,article:d,onClick:c=>w(d.id)},null,8,["article","onClick"]))),128)),v(D,{modelValue:i.value,"onUpdate:modelValue":r[0]||(r[0]=d=>i.value=d),"slot-transition-name":"slide"},{default:g(()=>[u("div",le,[(l(),h(E,null,{fallback:g(()=>[v(re)]),default:g(()=>[v(te,{id:_.value,onCancel:m},null,8,["id"])]),_:1}))])]),_:1},8,["modelValue"])]))}});var he=k(ne,[["__scopeId","data-v-9293cda4"]]);export{he as default};
